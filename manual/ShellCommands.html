<html dir="ltr"><head></head><body dir="ltr">

<h1>4 Команды оболочки Flora-2</h1>

Загрузка баз знаний из файлов. Наиболее распространенными командами оболочки, которые вам, вероятно, понадобятся, являются команды для загрузки и компиляции баз знаний:

<p>

Здесь myfile или myurl - это имена файлов (как вариант URL-адреса), которые предположительно указывают на базу знаний Flora-2 или программу на Prolog. И myfile, и URL должны быть атомами Пролога. Если они содержат не буквенно-цифровые символы (как в приведенных выше примерах), они должны быть выделены одинарными кавычками (как обычно для атомов Пролога). URL-адрес ожидается, когда аргумент имеет форму url (myurl).
7 Файл может относиться к каталогу, в котором была запущена Flora-2. Например, если в этом каталоге есть файл foo.flr, вы можете просто ввести [foo] вместо ['/home/me/foo.flr] или даже [' / home / me / foo ']. Обратите внимание, что наш первый файл примера «c: / Мои документы / данные» является именем файла Windows, за исключением того, что он использует прямые косые черты (например, в URL-адресах), что предпочтительнее обратным косым чертам. Обратные слеши также могут использоваться в Windows, но их необходимо удвоить: «c: \\ Мои документы \ данные». В системах на базе Unix, таких как Linux и Mac, можно использовать только прямые слеши.

<p>

Если myfile.flr существует, предполагается, что это база знаний, написанная для Flora-2. При необходимости система будет компилировать базу знаний, а затем загружать ее. Процесс компиляции двухэтапный: во-первых, база знаний будет скомпилирована в Prolog-программу (один или несколько файлов с расширениями .pl, .fdb и другие), а затем в исполняемый байт-код с расширением .xwam. Например, команды

<p>

<pre>
flora2 ?- load{url(’http://example.com/test1’)}.
flora2 ?- [url(’http://example.com/test2’)].
</pre>

<p>

будут компилировать (при необходимости) и загружать Flora-файлы test1.flr и test2.flr, найденные на веб-сайте http://example.com/.

<p>

Если файл myfile.flr отсутствует, предполагается, что файл содержит Prolog-программу, и система будет искать файл с именем myfile.P.Затем этот файл компилируется в файл myfile.xwam и загружается.
Обратите внимание, что в этом случае программа загружается в Prolog-модуль Flora-2, поэтому вызовы предикатов, определенных в этой программе, должны использовать соответствующую атрибуцию модуля - см. Раздел 16.1 для получения подробной информации о модульной системе в Flora-2 ,

<p>

По умолчанию все базы знаний Flora-2 загружаются в модуль main, но вы также можете загружать его в другие модули, используя следующую команду:

<p>

<pre>
flora2 ?- [myfile &gt;&gt;modulename ].
flora2 ?- [url(myurl )&gt;&gt;modulename ].
</pre>

<p>

Понимание модулей Flora-2 очень важно, чтобы иметь возможность полностью использовать преимущества системы; Мы обсудим модульную систему Флоры-2 в разделе 16.1. После загрузки базы знаний вы можете создавать запросы и вызывать методы для объектов, определенных в этой базе знаний.

<p>

Все команды загрузки, применимые к файлам, также применимы к URL-адресам, поэтому в будущем мы будем приводить примеры только для файлов.

<p>

Существует важный частный случай команд загрузки {...} и [...], когда отсутствует имя файла. В этом случае Flora-2 создает файл с записной книжкой и начинает считывать ввод пользователя. На этом этапе пользователь может начать печатать предложения Flora-2, которые система сохраняет в блокнотном файле. Когда пользователь выполнил ввод и набирает символ конца файла Control-D (Unix) или Control-Z (Windows), файл компилируется и загружается. Также можно загрузить блокнотный файл в назначенный модуль, а не модуль по умолчанию, используя одну из следующих команд:

<p>

<pre>
flora2 ?- [&gt;&gt;module].
flora2 ?- load{&gt;&gt;module}.
</pre>

<p>

Добавление правил в модули. Когда команда load {...} загружает базу правил в модуль, она сначала уничтожает все правила и факты, которые ранее формировали базу знаний этого модуля.
Иногда желательно добавить факты и правила, содержащиеся в определенном файле, в уже существующую базу знаний модуля. Эта операция, называемая add {...}, не уничтожает старую базу знаний в рассматриваемом модуле. Также возможно использовать синтаксис [...], используя префикс имени файла -- знак +. Вот несколько примеров добавления базы правил, содержащейся в файлах, в существующие модули:

<p>

<pre>
flora2 ?- [+foo].
flora2 ?- [+foo&gt;&gt;bar].
flora2 ?- add{foo}.
flora2 ?- add{foo&gt;&gt;bar}.
</pre>

<p>

При использовании синтаксиса [...] добавление и загрузка могут быть перемешаны. Например,

<p>

<pre>
flora2 ?- [foo&gt;&gt;bar, +foo2&gt;&gt;bar].
</pre>

<p>

Сначала он загружает файл foo.flr в модуль bar, а затем добавляет базу правил, содержащуюся в foo2.flr, в тот же модуль.

<p>

Перезагрузка и повторное добавление. Перекомпиляция. Flora-2 load {...} и add {...} стараются быть умными, чтобы упростить обслуживание баз знаний и избежать нежелательных побочных эффектов. Во-первых, перезагрузка и повторное добавление одного и того же файла в тот же модуль не будет иметь никакого эффекта, если только один из зависимых файлов не изменится со времени предыдущей загрузки / добавления. Таким образом, циклические команды добавления / загрузки безвредны, хотя они и являются доказательством плохого дизайна.

<p>

Для целей перекомпиляции зависимым файлом является тот, который включен через директиву компилятора #include. Свойство зависимости транзитивно, поэтому, если какой-либо из зависимых файлов, наследующий изменения из родительского, изменяется, загрузка или добавление родительского файла приведет к перекомпиляции родителя.

<p>

Аналогичная зависимость существует для load / add. Обычно, как мы сказали, перезагрузка файла не будет иметь никакого эффекта. Но что если загружаемый (или добавленный) файл имеет явную команду load / add, которая загружает другой файл (который мы называем зависимым по загрузке)? Если зависимый файл был изменен с момента последней загрузки, его необходимо перезагрузить и перекомпилировать. В этом случае, если родительский файл перезагружается, эта перезагрузка будет иметь место, и поэтому все команды load / add в этом файле будут перезаписаны, что приведет к перезагрузке всех соответствующих зависимых по загрузке файлов. Такая загрузка будет иметь место, если изменится кто-либо из зависимых по загрузке - на любом уровне вниз по потоку от родителя.

<p>

Вывод ответов на запросы. Когда пользователь вводит запрос в оболочку, запрос вычисляется и возвращается результат. Результатом является кортеж значений для каждой переменной, упомянутой в запросе, за исключением анонимных переменных, представленных как «?_" или ?, и называются ненужные переменные, которым предшествует символ подчеркивания, например,?_abc.

<p>

По умолчанию Flora-2 распечатывает все ответы (если их число конечно). Если требуется только по одному, введите следующую команду: \one. Вы можете вернуться в режим «все ответы», набрав \all. Примечание: \one и \all влияют только на последующие запросы. То есть, в

<p>

<pre>
flora2 ?- \one, goallist1.
flora2 ?- goallist2.
</pre>

<p>

Директива \one будет влиять только на goallist2, но не goallist1. Это связано с тем, что goallist1 выполняется в том же запросе, что и \one, и поэтому эта директива не затрагивается.

<p>

В оболочке Flora-2 есть еще много команд, кроме тех, что упомянуты выше. Эти команды перечислены ниже. Однако в этот момент цель некоторых из этих команд может показаться немного загадочной, поэтому неплохо вернуться сюда после того, как вы лучше познакомитесь с различными концепциями, лежащими в основе системы.

<p>

Сводка команд оболочки. В следующем списке команд суффиксы .flr.P, .xwam являются необязательными. Если суффикс файла указан явно, система использует файл с данным именем без каких-либо изменений. Суффикс .flr обозначает базу знаний Flora-2.Суффикс P указывает, что это программа Prolog, а .xwam означает, что это файл байт-кода, который может быть выполнен Prolog.
Если суффикс не указан, система предполагает, что он имеет дело с базой знаний Flora-2 и добавляет суффикс .flr. Если файл с таким именем не существует, он предполагает, что файл содержит программу Prolog и пытается использовать суффикс.P. В противном случае он пытается найти .xwam файл в надежде на существование исполняемого байт-кода Prolog. Если ни одна из этих попыток не выполнена успешно, сообщается об ошибке.

<p>

<ul>
<li>\help: Показать справочную информацию.
<li>compile{file}: Скомпилировать FILE.flr для основного модуля по умолчанию.
<li>compile{file&gt;&gt;module}: Скомпилировать FILE.flr для модуля module.
<li>load{file&gt;&gt;module}: загрузить файл.flr в модуль module. Если вы укажете файл.P или file.xwam загружаются эти файлы.
<li>load{file}: загрузить файл.flr в основной модуль по умолчанию. Если вы укажете файл.P или file.xwam загружаются эти файлы.
<li>compile{file}: Скомпилировать FILE.flr для добавления к модулю main по умолчанию.
<li>Compileadd {file &gt;&gt; module}: Скомпилировать FILE.flr для добавления модуля модуля.
<li>Add {file &gt;&gt; module}: Добавить файл.flr в модуль модуля.
<li>Add {file}: Добавить file.flr в основной модуль по умолчанию.
<li>``file``P | xwam | flr}&gt;&gt; module, ...]: Загрузите файлы в указанном списке в модуль модуля. Файлы необязательно могут иметь префикс «+», что означает, что файл должен быть добавлен в модуль, а не загружен в него.
<li>Demo {demofilename}: ознакомьтесь с демонстрацией демо-каталога Flora-2 demos.
<li>Op {Приоритет, Ассоциативность, Оператор}: Определите оператор в режиме оболочки.
<li>\ All: Показать все решения (по умолчанию). Влияет только на последующие запросы.
<li>\ One: Показывать решения для последующих запросов один за другим.
<li>\ Trace / \ notrace: включить / выключить трассу Flora-2.
<li>Chatter {on} / chatter {off}: включение / выключение отображения количества решений в конце каждой оценки запроса.
<li>Обратная связь {on} / feedback {off}: включение / выключение отображения ответов на запрос. В основном используется в Java-приложениях.
<li>Setwarnings {type}: контролировать типы предупреждений, которые должны отображаться пользователю.
<ul>
<li>All - показать все предупреждения (по умолчанию)
<li>Off - не показывать никаких предупреждений
<li>Compiler = on, compiler = off - включить предупреждения компилятора (по умолчанию) или выключить; Не влияет на другие типы предупреждений
<li>Dependency = on / off - вызывать предупреждения проверки зависимостей по умолчанию (по умолчанию) или выключен; Не влияет на другие типы предупреждений
<li>Runtime = on / off - включить предупреждения о запуске (по умолчанию) или выключить; Не влияет на другие типы предупреждений.
</li></li></li></li></li></ul>
<li># WarningsТип}: укажите, какие параметры управления предупреждением действуют. ?Тип может быть переменной или шаблоном, подобным компилятору =?Х.
<li>\end: Скажите чао Flora-2, но оставайтесь в Prolog. Вы можете повторно запустить Flora-2, выполнив команду flora_shell в командной строке Prolog.
<li>\halt: Выход из Flora-2, и Prolog.
</li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></ul>

<p>

Конечно, многие другие исполняемые директивы и запросы могут быть выполнены в оболочке Flora-2.
Они описаны далее в этом руководстве

<p>

В общем, встроенные предикаты Flora-2, чье имя имеет форму fl[A-Z]..., являются либо командами оболочки или предикатами Flora-2, которые могут использоваться в Prolog для управления выполнением модулей Flora-2. Мы обсудим это в разделе 16.8. Некоторые из этих команд, в основном связанные с загрузкой и компиляцией модулей Flora-2, также могут быть полезны в приложениях Flora-2.

<p>

Все команды с аргументом FILE, переданные им, используют предикат Prolog library_directory для поиска файла, за исключением того, что команда demo{FILE} сначала ищет FILE в демо-каталоге Flora-2. Путь поиска обычно включает стандартные каталоги системы, используемые Prolog, за которыми следует текущий каталог.

<p>

Все команды Prolog могут быть выполнены из оболочки Flora-2, если соответствующая библиотека Prolog уже загружена.

<p>

После ошибки синтаксического анализа или компиляции оболочка Flora-2 будет отбрасывать токены, считанные из текущего входного потока, до тех пор, пока не будет обнаружен конец файла или разделитель правил («.»). Если оболочка Flora-2, похоже, висит после сообщения

<p>

<pre>
++Warning[Flora-2]: discarding tokens (rule delimiter ‘.’ or EOF expected)
</pre>

<p>

Нажмите клавишу Enter один раз, введите «.», а затем снова Enter. Это должно привести к сбросу текущего входного буфера, и вы увидите командную строку Flora-2:

<p>

<pre>
flora2 ?-
</pre>
</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></body></html>